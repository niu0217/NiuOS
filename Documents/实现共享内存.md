# 实现共享内存

## 1. 修改linux-0.11/include/unistd.h

![image-20240426135551661](实现共享内存.assets/image-20240426135551661.png) 

## 2. 修改linux-0.11/kernel/system_call.s

![image-20240426135650587](实现共享内存.assets/image-20240426135650587.png) 

## 3. 修改linux-0.11/include/linux/sys.h

![image-20240426135734875](实现共享内存.assets/image-20240426135734875.png) 

## 4. 新建linux-0.11/include/shm.h

![image-20240426135829561](实现共享内存.assets/image-20240426135829561.png) 

## 5. 新建linux-0.11/kernel/shm.c

![image-20240426140504443](实现共享内存.assets/image-20240426140504443.png) 

##  6. 修改linux-0.11/kernel/Makefile

![image-20240426140627294](实现共享内存.assets/image-20240426140627294.png) 

![image-20240426140656707](实现共享内存.assets/image-20240426140656707.png) 

## 7. 测试程序

### 7.1 test/test_shared_memory/writeM.c

![image-20240426141540229](实现共享内存.assets/image-20240426141540229.png) 

### 7.2 test/test_shared_memory/readM.c

![image-20240426141613589](实现共享内存.assets/image-20240426141613589.png) 

## 8. 最后的准备

```bash
ubuntu@VM-0-16-ubuntu:~/GithubFile/NiuOS$ sudo ./mount-hdc 

ubuntu@VM-0-16-ubuntu:~/GithubFile/NiuOS$ cp ./linux-0.11/include/unistd.h ./hdc/usr/include/

ubuntu@VM-0-16-ubuntu:~/GithubFile/NiuOS$ cp ./linux-0.11/include/shm.h ./hdc/usr/include/

ubuntu@VM-0-16-ubuntu:~/GithubFile/NiuOS$ cp -r ./test/test_shared_memory/. ./hdc/usr/root/

ubuntu@VM-0-16-ubuntu:~/GithubFile/NiuOS$ sudo umount hdc
```

## 9. 出结果

![image-20240426143056408](实现共享内存.assets/image-20240426143056408.png) 

 



